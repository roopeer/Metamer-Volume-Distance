# -*- coding: utf-8 -*-
"""dist

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1NI_Uejly8W48uuUAk8Uu-emq0kQHCUyA
"""

import numpy as np
from scipy.spatial import ConvexHull
import pygel3d
from pygel3d import hmesh as gel

def dist(hull, points):
    m = gel.Manifold()
    for s in hull.simplices:
        m.add_face(hull.points[s])

    dist = gel.MeshDistance(m)
    res = []
    for p in points:
        d = dist.signed_distance(p)[0]
        if dist.ray_inside_test(p):
            d = 0.
        else:
            if d < 0:
                d *= -1
        res.append(d)
    return np.array(res)